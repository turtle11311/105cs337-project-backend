<!DOCTYPE html>
<html>
<head>
  <title><%= title %></title>
  <link type="text/css" rel="stylesheet" href="/stylesheets/style.css">
  <link href="http://cdn.bootcss.com/highlight.js/8.0/styles/monokai_sublime.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"
          integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
          crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.fancytree/2.21.0/jquery.fancytree.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/jquery.fancytree/2.21.0/skin-win8/ui.fancytree.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.customSelect/0.5.1/jquery.customSelect.js"></script>
  <script type="text/javascript">
    var repo = 'miner_backend'
    function init() {
      $(function () {
        // Create the tree inside the <div id="tree"> element.
        $("#tree").fancytree({
          source: {
            url: `/apis/fs/${repo}/list`
          },
          checkbox: true,
          activate: function(event, data) {
            // A node was activated: display its title:
            var node = data.node;
            if (node.folder) return;
            $.ajax({
              method: 'GET',
              url: `/apis/fs/${repo}/${node.key}`,
              success: function (data, textStatus, jqXHR) {
                var editor = ace.edit("editor");
                editor.setValue(data);
              }
            })
          }
        });
      });
    }
  </script>
</head>

<body onload="init()">
  <div class="container">
    <div class="function">
      <h1>Function</h1>

    </div>
    <div class="con_code">
      <div class="treeView">
        <div id="tree"></div>
      </div>
      <div id="editor"></div>
      <div class="editor_option">
        Please select:
          <select id="theme" onchange="loadtheme()">
          </select>
          <select id="language" onchange="loadtheme()"></select>
      </div>
    </div>

  </div>
  <script src="/ace-builds/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
  <script>

    
    var theme = ['ambiance', 'chaos', 'chrome', 'clouds', 'clouds_midnight', 'cobalt', 'crimson_editor', 'dawn', 'dreamweaver', 'eclipse', 'github', 'idle_fingers', 'iplastic', 'katzenmilch', 'kr_theme', 'kuroir', 'merbivore', 'merbivore_soft', 'mono_industrial', 'monokai', 'pastel_on_dark', 'solarized_dark', 'solarized_light', 'sqlserver', 'terminal', 'textmate', 'tomorrow', 'tomorrow_night', 'tomorrow_night_blue', 'tomorrow_night_bright', 'tomorrow_night_eighties', 'twilight', 'vibrant_ink', 'xcode'];
    var language = ['c_cpp', 'html', 'javascript', 'java'];
    $('select#theme').append($("<option></option>").attr("value", 0).text("Choose a theme"));
    for (var i = 0; i < theme.length; i++) {
      $('select#theme').append($("<option></option>").attr("value", theme[i]).text(theme[i]));
    }
    $('select#language').append($("<option></option>").attr("value", 0).text("Choose a language"));
    for (var i = 0; i < language.length; i++) {
      $('select#language').append($("<option></option>").attr("value", language[i]).text(language[i]));
    }
    var $th = $('#theme').customSelect();
    var $la = $('#language').customSelect();
    function loadtheme() {
      var editor = ace.edit("editor");
      editor.setTheme("ace/theme/" + $('select#theme').find(":selected").val());
      editor.session.setMode("ace/mode/" + $('select#language').find(":selected").val());
    }
  </script>

</body>

</html>